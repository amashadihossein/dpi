<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>dpi • dpi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="dpi">
<meta property="og:description" content="dpi">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dpi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dpi.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amashadihossein/dpi/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="dpi_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>dpi</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/amashadihossein/dpi/blob/master/vignettes/dpi.Rmd"><code>vignettes/dpi.Rmd</code></a></small>
      <div class="hidden name"><code>dpi.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dpi</span><span class="op">)</span></code></pre></div>
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h1>
<p>This package aims to provide a minimalist and uniform interface for retrieving data products and the associated metadata no matter where the data product is housed. Currently, s3 and labkey are two types of remote repositories for housing data products.</p>
<p>This packages leverages the <code>pins</code> package for accessing data. As such, it leverage the concept of <code>boards</code> for organizing data into <strong>data spaces</strong>. As an example, a team working on multiple clinical studies, may consider defining a data space or <code>board</code> for each study, each of which defined by a governance policy. In this example, a <code>board</code> is not dissimilar to the idea of a directory or folder. A board can be instantiated on different data platforms (e.g. AWS s3) supported by <code>pins</code> or its extensions.</p>
<p>As different data platforms (e.g. s3 vs. labkey) have their own specific url and ways of authentication, different parameters need to be set up for how connection to the remote data repository is to be established. Once the connection is established, however, all other interactions (e.g. list, get, version, etc.) are done using the same set of functions. With that in mind, the steps outlined below are divided into</p>
<ol style="list-style-type: decimal">
<li>Setting up the connection</li>
<li>Interacting with the data product</li>
</ol>
</div>
<div id="set-up-connection" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up-connection" class="anchor"></a>Set up connection</h1>
<p>Setting up connection to data products involves setting</p>
<ol style="list-style-type: decimal">
<li>Board parameters: parameters relating to the remote location of the data product</li>
<li>Credential parameters: parameters checked by the remote location of the data when trying to access</li>
</ol>
<p><strong>NOTE:</strong> prior to proceeding further verify that you have working credentials for the repository you need to access.</p>
<div id="board-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#board-parameters" class="anchor"></a>Board parameters</h2>
<p>Currently data products housed on either Labkey or AWS s3 are supported.</p>
<ul>
<li>For s3, you need to know the bucket name and the region.</li>
<li>For Labkey, you need to know the url of platform and specific folder.</li>
</ul>
</div>
<div id="format-board-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#format-board-parameters" class="anchor"></a>Format board parameters</h2>
<p>For S3, you need to provide an alias that signifies the data space this data product could belong to.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">board_params_s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/board_params_set_s3.html">board_params_set_s3</a></span><span class="op">(</span>board_alias <span class="op">=</span> <span class="st">"an_alias_for_data_board"</span>,
                                 bucket_name <span class="op">=</span> <span class="st">"bucket_name"</span>,
                                 region <span class="op">=</span> <span class="st">"us-east-1"</span><span class="op">)</span></code></pre></div>
<p>The Labkey parameters for a data product will have pattern as given below</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">board_params_labkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/board_params_set_labkey.html">board_params_set_labkey</a></span><span class="op">(</span>board_alias <span class="op">=</span> <span class="st">"labkey"</span>,
                                               url <span class="op">=</span> <span class="st">'https:url_to_labkey/labkey'</span>,
                                               folder <span class="op">=</span> <span class="st">'/project_folder/subfolder'</span><span class="op">)</span></code></pre></div>
</div>
<div id="format-your-credentials" class="section level2">
<h2 class="hasAnchor">
<a href="#format-your-credentials" class="anchor"></a>Format your credentials</h2>
<p>This can be done with <code>cred_set_aws</code> or <code>cred_set_labkey</code> functions. The cred_set function signatures informs you of the type of parameters needed.</p>
<p><strong>NOTE:</strong> For security reasons, avoid putting your credentials inside your script. It is highly recommended to establish a habit of using environment variables in conjunction with secret management packages like <code>keyring</code>. Below, exemplifies this pattern, where the env variables are set using <code><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv("AWS_KEY" = "xxxx")</a></code> in console, or using <code>keyring</code>, <code>Sys.setenv("AWS_KEY" = keyring::key_get(service = "AWS_KEY")</code>. Similarly, “AWS_SCRET” can be set as an environment variable.</p>
<p>The signature for creds for AWS s3 is takes two parameters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aws_creds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/creds_set_aws.html">creds_set_aws</a></span><span class="op">(</span>key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"AWS_KEY"</span><span class="op">)</span>,
                           secret <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"AWS_SECRET"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>If the data board was to be set up on Labkey, the signature for creds only takes one parameter <code>api_key</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">labkey_creds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/creds_set_labkey.html">creds_set_labkey</a></span><span class="op">(</span>api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"LABKEY_API_KEY"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="connect-and-interact-with-data-product" class="section level1">
<h1 class="hasAnchor">
<a href="#connect-and-interact-with-data-product" class="anchor"></a>Connect and interact with data product</h1>
<p>With the connection parameters established, interaction with the data product use the same set of function and format no matter where the data is housed.</p>
<div id="connect-to-the-board" class="section level2">
<h2 class="hasAnchor">
<a href="#connect-to-the-board" class="anchor"></a>Connect to the board</h2>
<p>Then we can connect to the board.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dp_connect.html">dp_connect</a></span><span class="op">(</span>board_params <span class="op">=</span> <span class="va">board_params_s3</span>, creds <span class="op">=</span> <span class="va">aws_creds</span><span class="op">)</span></code></pre></div>
</div>
<div id="work-with-the-board" class="section level2">
<h2 class="hasAnchor">
<a href="#work-with-the-board" class="anchor"></a>Work with the board</h2>
<p>List what data products available on this board we just connected to. Note we need to connect first in order to list.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dp_list.html">dp_list</a></span><span class="op">(</span>board_params <span class="op">=</span> <span class="va">board_params_s3</span><span class="op">)</span></code></pre></div>
</div>
<div id="retrieve-data" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieve-data" class="anchor"></a>Retrieve data</h2>
<p>Load data into the working environment, e.g. as object <code>dp</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dp_get.html">dp_get</a></span><span class="op">(</span>data_name <span class="op">=</span> <span class="st">"dp-studyid_branchid"</span>, 
            board_params <span class="op">=</span> <span class="va">board_params_s3</span>, 
            version <span class="op">=</span> <span class="st">"c5a51c3"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Afshin Mashadi-Hossein, Yue Jiang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
